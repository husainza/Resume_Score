<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Configuration Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold text-gray-900 mb-6">API Configuration Test</h1>
        
        <div class="bg-white rounded-lg shadow-sm border p-6 space-y-4">
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-2">Configuration Status</h2>
                <div id="configStatus" class="text-sm text-gray-600">
                    Loading...
                </div>
            </div>
            
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-2">API Key Status</h2>
                <div id="apiKeyStatus" class="text-sm text-gray-600">
                    Loading...
                </div>
            </div>
            
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-2">Service Status</h2>
                <div id="serviceStatus" class="text-sm text-gray-600">
                    Loading...
                </div>
            </div>
            
            <div class="pt-4 border-t">
                <button id="testBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Test API Connection
                </button>
            </div>
            
            <div id="testResult" class="hidden">
                <h3 class="font-medium text-gray-900 mb-2">Test Result:</h3>
                <div id="testOutput" class="bg-gray-100 p-3 rounded text-sm font-mono"></div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="api-service.js"></script>
    <script>
        // Test configuration and service
        function updateStatus() {
            // Configuration status
            const configErrors = validateConfig();
            const configStatus = document.getElementById('configStatus');
            if (configErrors.length > 0) {
                configStatus.innerHTML = `<span class="text-red-600">❌ Configuration errors: ${configErrors.join(', ')}</span>`;
            } else {
                configStatus.innerHTML = '<span class="text-green-600">✅ Configuration is valid</span>';
            }
            
            // API key status
            const apiStatus = getApiKeyStatus();
            const apiKeyStatus = document.getElementById('apiKeyStatus');
            if (apiStatus.configured) {
                apiKeyStatus.innerHTML = `<span class="text-green-600">✅ ${apiStatus.message}</span>`;
            } else {
                apiKeyStatus.innerHTML = `<span class="text-red-600">❌ ${apiStatus.message}</span>`;
            }
            
            // Service status
            const serviceStatus = document.getElementById('serviceStatus');
            if (typeof OpenAIService !== 'undefined') {
                serviceStatus.innerHTML = '<span class="text-green-600">✅ OpenAIService class is available</span>';
            } else {
                serviceStatus.innerHTML = '<span class="text-red-600">❌ OpenAIService class not found</span>';
            }
        }
        
        // Test API connection
        async function testConnection() {
            const testBtn = document.getElementById('testBtn');
            const testResult = document.getElementById('testResult');
            const testOutput = document.getElementById('testOutput');
            
            testBtn.disabled = true;
            testBtn.textContent = 'Testing...';
            testResult.classList.add('hidden');
            
            try {
                const service = new OpenAIService();
                const result = await service.testConnection();
                
                testOutput.textContent = `✅ Test successful: ${JSON.stringify(result, null, 2)}`;
                testResult.classList.remove('hidden');
            } catch (error) {
                testOutput.textContent = `❌ Test failed: ${error.message}`;
                testResult.classList.remove('hidden');
            } finally {
                testBtn.disabled = false;
                testBtn.textContent = 'Test API Connection';
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus();
            
            document.getElementById('testBtn').addEventListener('click', testConnection);
        });
    </script>
</body>
</html> 